
## HTTPS 란?
HTTPS(Hypertext Transfer Protocol Secure)는 HTTP의 보안 확장판으로, 웹 브라우저와 서버 간에 안전한 통신을 보장하기 위해 SSL(Secure Sockets Layer) 또는 TLS(Transport Layer Security)를 사용하여 데이터를 암호화하고, 무결성과 인증을 제공합니다. 여기서는 HTTPS와 SSL/TLS의 작동 원리, 인증서 발급 및 검증 과정, 브라우저와 인증 기관(CA)의 상호작용에 대해 자세히 설명하겠습니다.

### 1. **HTTPS의 주요 구성 요소 및 작동 원리**

#### **1.1 암호화 (Encryption)**
HTTPS는 SSL 또는 TLS 프로토콜을 사용하여 클라이언트와 서버 간의 데이터 통신을 암호화합니다. 암호화는 데이터를 중간자 공격(Man-In-The-Middle Attack)으로부터 보호하여 도청이나 변조를 방지합니다. 

#### **1.2 SSL/TLS 핸드셰이크 과정**
SSL/TLS 핸드셰이크는 HTTPS 연결의 시작 과정으로, 다음 단계를 거칩니다:

1. **Client Hello**: 클라이언트는 서버에 SSL/TLS 연결을 요청하면서 사용 가능한 암호화 방식(알고리즘) 목록을 전송합니다.
2. **Server Hello**: 서버는 클라이언트가 제안한 암호화 방식 중 하나를 선택하고, 서버의 인증서와 공개 키를 클라이언트에게 보냅니다.
3. **서버 인증서 검증**: 클라이언트는 서버의 SSL/TLS 인증서가 신뢰할 수 있는 인증 기관(CA)에 의해 발급되었는지 확인합니다.
4. **비밀 세션 키 생성**: 클라이언트는 대칭 암호화를 위해 사용할 세션 키를 생성하고, 서버의 공개 키를 사용해 이를 암호화하여 서버에 전송합니다.
5. **대칭 암호화 통신 시작**: 서버는 클라이언트가 전송한 세션 키를 자신의 개인 키로 해독한 후, 이후의 통신은 이 세션 키를 사용하여 대칭 암호화로 진행됩니다. 대칭 암호화는 성능을 높이기 위해 사용됩니다.

#### **1.3 데이터 무결성 (Data Integrity)**
데이터가 전송되는 과정에서 변조되지 않았음을 보장하는 것이 데이터 무결성입니다. SSL/TLS 프로토콜은 이 과정에서 **메시지 인증 코드(MAC)**를 사용합니다. MAC은 데이터를 송수신하는 양쪽에서 생성되는 일종의 디지털 지문으로, 데이터의 변경 여부를 확인할 수 있습니다.

#### **1.4 인증 (Authentication)**
HTTPS는 서버의 신원을 확인하는 과정에서 **인증서**를 사용합니다. 서버는 클라이언트에게 자신의 SSL/TLS 인증서를 제공하고, 클라이언트는 이를 검증하여 서버가 주장하는 엔티티가 실제로 맞는지 확인합니다. 인증서에는 서버의 공개 키와 함께 CA의 디지털 서명이 포함되어 있으며, 이 서명은 신뢰할 수 있는 CA에 의해 발급됩니다.

### 2. **SSL/TLS의 작동 원리**

SSL은 안전한 통신을 위한 표준 보안 기술로 시작되었으며, 이후 더 안전한 TLS로 발전하였습니다. SSL/TLS의 핵심 요소는 클라이언트와 서버 간 데이터 전송을 암호화하고, 인증을 통해 신뢰를 구축하며, 데이터 무결성을 보장하는 것입니다.

#### **2.1 SSL/TLS 핸드셰이크 프로토콜**
핸드셰이크 과정에서는 클라이언트와 서버 간의 신뢰 구축과 암호화 키의 교환이 이루어집니다. 이 과정에서 클라이언트와 서버는 세션 동안 사용할 암호화 알고리즘과 키를 협상하게 되며, 데이터 전송이 안전하게 이루어질 수 있도록 설정합니다.

#### **2.2 SSL/TLS 인증서의 역할**
SSL/TLS 인증서는 클라이언트가 서버의 신원을 확인할 수 있게 해주는 중요한 문서입니다. 이 인증서에는 서버의 도메인, 서버의 공개 키, 그리고 인증 기관의 서명이 포함되어 있으며, 클라이언트는 이 서명을 통해 서버가 신뢰할 수 있는 서버인지 확인합니다.

#### **2.3 데이터 무결성과 메시지 인증 코드 (MAC)**
SSL/TLS는 전송 중인 데이터가 변경되지 않았음을 보장하기 위해 **메시지 인증 코드(MAC)**를 사용합니다. MAC는 송신자가 생성한 메시지와 함께 전송되며, 수신자는 동일한 MAC을 재생성하여 메시지의 무결성을 확인합니다.

### 3. **SSL/TLS 인증서 발급 과정**

SSL/TLS 인증서는 신뢰할 수 있는 제3자 인증 기관(CA)에 의해 발급됩니다. 인증서는 서버와 클라이언트 간의 신뢰를 확립하는 중요한 요소입니다.

#### **3.1 인증서 발급 단계**
1. **키 생성**: 서버는 **공개 키**와 **개인 키**를 생성합니다. 공개 키는 인증서에 포함되고, 개인 키는 서버가 암호화 통신을 해독하는 데 사용됩니다.
2. **CSR(Certificate Signing Request) 생성**: 서버 소유자는 **인증서 서명 요청(CSR)**을 생성하여 CA에 제출합니다. CSR에는 서버의 공개 키와 서버 소유자의 정보가 포함됩니다.
3. **CA에 의한 검증**: 인증 기관은 서버 소유자의 신원을 검증하고, 도메인 소유권을 확인합니다.
4. **인증서 발급**: 검증이 완료되면, CA는 서버의 공개 키에 서명하여 SSL/TLS 인증서를 발급합니다.
5. **인증서 설치**: 서버 소유자는 발급받은 인증서를 서버에 설치하고 HTTPS를 활성화합니다.

### 4. **웹 브라우저와 인증 기관(CA)의 상호작용**

#### **4.1 루트 인증서 저장소**
웹 브라우저는 미리 설정된 **루트 인증서 저장소**를 통해 여러 신뢰할 수 있는 CA의 루트 인증서를 포함하고 있습니다. 루트 인증서에는 CA의 공개 키가 포함되어 있으며, 이를 통해 CA가 발급한 SSL/TLS 인증서의 유효성을 검증할 수 있습니다.

#### **4.2 브라우저 업데이트와 신뢰 저장소 관리**
브라우저는 CA의 신뢰성을 지속적으로 평가하며, 새로운 CA가 추가되거나 기존 CA가 삭제될 수 있습니다. 이러한 변경 사항은 브라우저 업데이트를 통해 반영됩니다. 또한, 운영 체제에 의해 관리되는 신뢰할 수 있는 루트 인증서 저장소를 브라우저가 참조하기도 합니다.

#### **4.3 인증서 검증 과정**
브라우저는 서버에서 받은 인증서를 CA의 루트 인증서를 사용해 검증하며, SSL/TLS 연결이 안전하고 신뢰할 수 있는지 확인합니다. 이 과정에서 만약 인증서가 유효하지 않거나 신뢰할 수 없는 경우, 브라우저는 경고 메시지를 표시합니다.

### 5. **HTTPS의 포트 및 응용**

- **HTTPS는 기본적으로 443번 포트**를 사용하며, 이는 HTTP가 사용하는 80번 포트와 구분됩니다.
- HTTPS는 보안이 중요한 **온라인 뱅킹, 전자 상거래, 로그인 페이지**와 같은 민감한 데이터를 다루는 웹사이트에서 널리 사용됩니다.
  
이러한 과정을 통해 HTTPS는 클라이언트와 서버 간의 안전한 통신을 보장하며, 인터넷 보안을 크게 향상시킵니다. SSL/TLS 인증서를 통해 사용자들은 웹사이트의 신뢰성을 확인할 수 있으며, 데이터는 안전하게 암호화되어 전송됩니다.

### 6 인증과정
![HTTPS 인증과정](../resource/HTTP/HTTPS인증과정.png)  
이 이미지에서 설명된 과정은 보통 웹사이트 인증을 처리하는 **공개 키 기반 구조(PKI)** 과정과 관련된 흐름을 시각적으로 설명한 것입니다. 이 과정은 인증 기관이 발급한 인증서를 사용하여 웹사이트나 서버와 클라이언트 간의 안전한 통신을 보장하는 방식입니다. 과정을 하나씩 설명하겠습니다.


이 이미지에 설명된 HTTPS 인증 과정을 더 자세히 설명하겠습니다.

### 1. **인증서 발급 요청 (1단계)**

- **서버 소유자**는 인증 기관(CA, Certificate Authority)에게 사이트 인증서를 발급받기 위해 **인증서 발급 요청(CSR)**을 보냅니다. 이 요청에는 사이트 정보와 **공개 키**가 포함되어 있습니다.
- 서버 소유자가 생성한 **공개 키와 개인 키** 중, 공개 키는 인증서에 포함되며, 개인 키는 서버가 보관합니다.

### 2. **CA가 서버 정보 확인 (2단계)**

- **인증 기관(CA)**은 서버에서 보낸 요청을 받은 후, 서버의 소유 여부와 도메인의 소유권을 검증합니다.
- CA는 요청에 포함된 **사이트 정보와 공개 키**가 적절한지 확인하고, 서버 소유자가 실제로 해당 도메인 소유자인지 확인합니다.

### 3. **인증서 발급 (3단계)**

- 검증이 완료되면 CA는 서버의 공개 키에 **디지털 서명**을 하여 **SSL/TLS 인증서**를 발급합니다.
- 이 인증서에는 서버의 도메인 이름, 서버의 공개 키, CA의 디지털 서명이 포함되어 있습니다.
- 이 과정은 CA가 해당 서버의 신원을 인증하고, 클라이언트가 이를 확인할 수 있도록 보장합니다.

### 4. **브라우저에 루트 인증서 제공 (4단계)**

- **CA**는 자신이 발급한 루트 인증서를 **브라우저나 운영 체제**에 사전 등록된 루트 인증서 저장소에 제공합니다.
- 브라우저는 이 저장소를 참조하여 서버에서 받은 인증서가 신뢰할 수 있는지 확인할 수 있습니다.
- 루트 인증서는 CA가 발급한 SSL/TLS 인증서를 검증할 때 필요한 공개 키를 포함하고 있습니다.

### 5. **사이트에 접속 요청 (5단계)**

- 사용자가 사이트에 접속하면, **브라우저**는 서버에 HTTPS 연결을 요청합니다. 이때, 브라우저는 **서버의 인증서**를 요청합니다.

### 6. **서버에서 인증서 전달 (6단계)**

- **서버**는 자신이 발급받은 **SSL/TLS 인증서**를 브라우저에 전송하여 자신의 신원을 증명합니다. 이 인증서에는 서버의 공개 키와 CA의 서명이 포함되어 있습니다.
- 이 과정에서 서버는 브라우저가 인증서를 검증할 수 있도록 합니다.

### 7. **브라우저에서 인증서 검증 (7단계)**

- **브라우저**는 서버에서 받은 인증서를 확인합니다. 이 과정에서 브라우저는 **인증서가 신뢰할 수 있는 CA**에 의해 발급되었는지, 인증서가 만료되지 않았는지, 인증서의 서명이 유효한지 등을 검사합니다.
- 브라우저는 서버의 인증서가 유효한지 확인하기 위해 **CA의 루트 인증서**를 참조하고, 이를 통해 서버의 인증서를 검증합니다.

### 8. **대칭키 생성 (8단계)**

- 브라우저가 서버 인증서를 신뢰할 수 있다고 판단하면, **대칭키**를 생성하여 서버에 전송합니다. 이 대칭키는 이후의 통신에 사용됩니다.
- 브라우저는 생성한 대칭키를 서버의 **공개 키**로 암호화하여 전송합니다. 서버는 자신의 **개인 키**로 이를 복호화하여 대칭키를 획득합니다.

### 9-11. **대칭키를 사용한 안전한 통신 (9~11단계)**

- 서버와 브라우저는 서로 확인을 완료한 후, 이제 **대칭키**를 사용하여 안전한 통신을 시작합니다.
- **대칭 암호화**는 양쪽 모두 동일한 키를 사용하여 데이터를 암호화하고 복호화할 수 있습니다. 대칭키를 사용하면 데이터 전송 속도가 빠르며, 보안도 강화됩니다.
- 이 대칭키로 암호화된 통신은 중간에서 도청되더라도 해독할 수 없기 때문에 안전합니다.

---

### **핵심 요약**
1. **서버 소유자**는 CA에게 인증서 발급을 요청하고, CA는 서버의 신원과 공개 키를 확인하여 **SSL/TLS 인증서**를 발급합니다.
2. 브라우저는 서버의 **인증서**를 검증하여 서버의 신뢰성을 확인합니다.
3. 서버와 브라우저는 **대칭키**를 생성하여 안전하게 데이터를 주고받습니다.

이 과정을 통해 클라이언트와 서버 간의 통신이 안전하게 이루어지며, 중간자 공격을 방지할 수 있습니다.